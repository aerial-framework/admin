<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   width="400" height="300" title="Recent Projects"
			   close="PopUpManager.removePopUp(this); close.dispatch()"
			   creationComplete="refreshProjects()">
	<s:layout>
		<s:VerticalLayout paddingBottom="8" paddingLeft="8" paddingRight="8" paddingTop="8"/>
	</s:layout>
	
	<fx:Script>
		<![CDATA[
			import controllers.NavigationController;
			import controllers.ProjectController;
			
			import models.Project;
			
			import mx.collections.ArrayList;
			import mx.events.CloseEvent;
			import mx.managers.PopUpManager;
			
			import org.osflash.signals.Signal;
			
			public var close:Signal = new Signal();
			
			private function refreshProjects():void
			{
				var projects:Array = ProjectController.instance.getProjects();
				
				projectsList.dataProvider = new ArrayList(projects);
			}
			
			private function projectSelected(event:MouseEvent):void
			{
				if(!projectsList.selectedItem as Project)
					return;
				
				ProjectController.instance.projectSelect.dispatch(projectsList.selectedItem as Project);
				dispatchEvent(new CloseEvent(CloseEvent.CLOSE));
				
				NavigationController.instance.navigationChange.dispatch(NavigationController.ACTIONS);
			}
			
		]]>
	</fx:Script>
	
	<s:List id="projectsList" width="100%" height="100%" borderColor="#EFEFEF" borderVisible="true"
			itemRenderer="renderers.ProjectListItemRenderer"/>
	
	<s:controlBarContent>
		<s:HGroup width="100%">
			<mx:Button label="Cancel" icon="@Embed('assets/icons/back.png')" click="dispatchEvent(new CloseEvent(CloseEvent.CLOSE))"/>
			
			<s:Spacer width="100%"/>
			
			<mx:Button label="Select" enabled="{projectsList.selectedItem}" fontWeight="normal"
					   icon="@Embed('assets/icons/next.png')" labelPlacement="left"
					   click="projectSelected(event)"/>			
		</s:HGroup>
	</s:controlBarContent>
	
	<fx:Declarations>
		
	</fx:Declarations>
</s:TitleWindow>
